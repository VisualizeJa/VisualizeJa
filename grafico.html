<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VisualizeJÃ¡ - Dashboard</title>
  <link rel="stylesheet" href="css/style-dashboard.css" />
  <link rel="stylesheet" href="css/style.home.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
</head>
<body>
<header>
  <a href="index.html" class="btn-voltar">â† Voltar para InÃ­cio</a>
  <div class="logo">Visualize<span style="color:#10B981">JÃ¡</span></div>
  <nav class="menu">
    <a href="#" data-aba="upload">ğŸ“ Upload</a>
    <a href="#" data-aba="base">ğŸ“Š Base de Dados</a>
    <a href="#" data-aba="dashboard">ğŸ“ˆ Dashboard</a>
  </nav>
  <button id="toggleTheme" class="btn-tema">ğŸŒ™</button>
</header>

<main>
  <!-- Upload -->
  <section id="upload" class="aba ativa">
    <h2>ğŸ“ Upload de Arquivo</h2>
    <input type="file" id="inputExcel" accept=".xlsx, .xls" />
    <p>Ou <button onclick="inserirBaseExemplo()">Usar base de exemplo</button></p>
  </section>

  <!-- Base de Dados -->
  <section id="base" class="aba">
    <h2>ğŸ“Š Base de Dados</h2>
    <div class="coluna-selecionada-box">
      <label for="selecionarColuna">ğŸ¯ Coluna Selecionada:</label>
      <select id="selecionarColuna" onchange="selecionarColunaManual(this.value)">
        <option value="">-- Selecione uma coluna --</option>
      </select>
    </div>

    <div class="menu-transformacoes-horizontal">
      <label>ğŸ§  Tipo de dado:</label>
      <select id="tipoDado">
        <option value="">-- Selecione --</option>
        <option value="moeda">Moeda</option>
        <option value="peso">Peso</option>
        <option value="data">Data</option>
        <option value="percentual">Percentual</option>
      </select>

      <label>âš™ï¸ OpÃ§Ãµes:</label>
      <select id="campoExtra">
        <option>Selecione um tipo</option>
      </select>

      <button onclick="arredondarColuna()">ğŸ”¢ Arredondar</button>
      <button onclick="aplicarTransformacao()">ğŸ“… Aplicar</button>
      <button onclick="abrirSubstituir()">ğŸ”„ Substituir</button>
      <button onclick="limparSelecaoManual()">âŒ Limpar SeleÃ§Ã£o</button>
      <button onclick="exportarExcel()">ğŸ“¤ Exportar Excel</button>
      <button onclick="desfazerTransformacoes()">â†©ï¸ Desfazer</button>
    </div>

    <div class="menu-transformacoes-horizontal">
      <button onclick="adicionarLinha()">â• Linha</button>
      <button onclick="removerLinhaSelecionada()">âŒ Linha</button>
      <button onclick="adicionarColuna()">â• Coluna</button>
      <button onclick="removerColunaSelecionada()">âŒ Coluna</button>
    </div>

    <div class="filtro-box">
      <select id="colunaFiltro"></select>
      <input id="valorFiltro" placeholder="Filtrar valor..." />
      <button onclick="aplicarFiltro()">Filtrar</button>
      <button onclick="limparFiltro()">Limpar</button>
    </div>

    <div class="tabela-container">
      <table id="tabela-dinamica">
        <thead><tr id="thead-row"></tr></thead>
        <tbody id="tbody-dados"></tbody>
      </table>
    </div>

    <div id="painelEstatisticas" class="painel-estatisticas"></div>
  </section>

  <!-- Dashboard -->
  <section id="dashboard" class="aba">
    <h2>ğŸ“ˆ Dashboard</h2>
    <div class="painel-config-graficos">
      <select id="tipoGrafico">
        <button onclick="desfazerUltimoGrafico()" class="btn-desfazer">â†©ï¸ Desfazer</button>

        <option value="bar">ğŸ“Š Barras</option>
        <option value="line">ğŸ“ˆ Linha</option>
        <option value="pie">ğŸ¥§ Pizza</option>
        <option value="scatter">ğŸ”µ DispersÃ£o</option>
        <option value="radar">ğŸ•¸ï¸ Radar</option>
        <option value="area">ğŸ”ï¸ Ãrea</option>
      </select>

      <select id="colunaX"></select>
      <select id="colunaY"></select>

      <select id="tipoAgregacao">
        <option value="Soma">â• Soma</option>
        <option value="MÃ©dia">âš–ï¸ MÃ©dia</option>
        <option value="Contagem">ğŸ”¢ Contagem</option>
        <option value="MÃ¡ximo">ğŸ”¼ MÃ¡ximo</option>
        <option value="MÃ­nimo">ğŸ”½ MÃ­nimo</option>
      </select>
   <button onclick="desfazerUltimoGrafico()" class="btn-desfazer">â†©ï¸ Desfazer</button>
      <button onclick="criarPainelGrafico()">â• Criar GrÃ¡fico</button>
      <button onclick="criarCartaoIndicador()">ğŸ“Œ Adicionar CartÃ£o</button>
    </div>

    <div id="area-graficos" class="area-graficos" style="display:flex; flex-wrap:wrap; gap:10px;"></div>
  </section>
</main>

<!-- Modal Substituir -->
<div id="modalSubstituir" class="modal">
  <div class="modal-conteudo">
    <h3>ğŸ”„ Substituir valor</h3>
    <label>Coluna:</label>
    <select id="colunaSubstituir"></select>
    <label>De:</label>
    <input type="text" id="valorDe" />
    <label>Para:</label>
    <input type="text" id="valorPara" />
    <div class="modal-botoes">
      <button onclick="aplicarSubstituicao()">âœ… Aplicar</button>
      <button onclick="fecharSubstituir()">âŒ Cancelar</button>
    </div>
  </div>
</div>

<!-- Painel lateral correto -->
<div id="painelConfiguracao" class="painel-lateral" style="display:none">
  <h3>âš™ï¸ Configurar GrÃ¡fico</h3>

  <label>TÃ­tulo:</label>
  <input type="text" id="editTitulo" />

  <label>Tipo de GrÃ¡fico:</label>
  <select id="editTipoGrafico">
    <option value="bar">ğŸ“Š Barras</option>
    <option value="line">ğŸ“ˆ Linha</option>
    <option value="pie">ğŸ¥§ Pizza</option>
    <option value="scatter">ğŸ”µ DispersÃ£o</option>
    <option value="radar">ğŸ•¸ï¸ Radar</option>
    <option value="area">ğŸ”ï¸ Ãrea</option>
  </select>

  <label>Eixo X:</label>
  <select id="editColunaX"></select>

  <label>Eixo Y:</label>
  <select id="editColunaY"></select>

  <label>AgregaÃ§Ã£o:</label>
  <select id="editAgregacao">
    <option value="Soma">â• Soma</option>
    <option value="MÃ©dia">âš–ï¸ MÃ©dia</option>
    <option value="Contagem">ğŸ”¢ Contagem</option>
    <option value="MÃ¡ximo">ğŸ”¼ MÃ¡ximo</option>
    <option value="MÃ­nimo">ğŸ”½ MÃ­nimo</option>
  </select>

  <hr>

  <label>ğŸ¨ Cor do GrÃ¡fico:</label>
  <input type="color" id="editCorGrafico" value="#3B82F6" />

  <label>ğŸ”  Cor do TÃ­tulo:</label>
  <input type="color" id="editCorTitulo" value="#FFFFFF" />

  <label>ğŸ”  Tamanho do TÃ­tulo:</label>
  <input type="number" id="editTamanhoTitulo" value="16" min="10" max="36" />

  <label>ğŸ”¤ Cor dos RÃ³tulos:</label>
  <input type="color" id="editCorRotulo" value="#FFFFFF" />

  <label>ğŸ”¤ Tamanho dos RÃ³tulos:</label>
  <input type="number" id="editTamanhoRotulo" value="12" min="8" max="24" />

  <br><br>
  <button onclick="aplicarConfiguracaoGrafico()" class="btn-aplicar">Aplicar</button>
  <button onclick="fecharPainelConfiguracao()" class="btn-fechar">Fechar</button>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
<script src="js/main.js"></script>
<script src="js/upload.js"></script>
<script src="js/base.js"></script>
<script src="js/dashboard.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    if (typeof atualizarColunasDashboard === "function") {
      atualizarColunasDashboard();
    }
  });
</script>
</body>
</html>
